cd /root/coziyoo-v2
git pull

# 1) migrate schema (adds latitude/longitude + short_id columns)
npm run db:migrate

# 2) clean users/foods/orders (and dependent rows via CASCADE)
# make sure DATABASE_URL is correct first
export DATABASE_URL='postgresql://coziyoo:coziyoo@127.0.0.1:5432/coziyoo'
psql "$DATABASE_URL" -f scripts/clear_users_orders_foods.sql

# 3) run seed
python3 -u scripts/seed_api_sample_load.py \
  --base-url http://127.0.0.1:3000 \
  --database-url "$DATABASE_URL" \
  --buyers 10 \
  --sellers 10 \
  --categories 5 \
  --foods-per-seller 5 \
  --orders-per-buyer 5 \
  --admin-email admin@coziyoo.com \
  --admin-password 12345 \
  --buyer-password Buyer12345! \
  --seller-password Seller12345! \
  --order-interval-seconds 0.5 \
  --out scripts/seed_api_sample_load_output.json

# 4) check summary
cat scripts/seed_api_sample_load_output.json
